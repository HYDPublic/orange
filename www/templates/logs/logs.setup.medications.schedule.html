<ion-view hide-nav-bar="false" view-title="Schedule">
    <ion-nav-bar class="bar-orange" align-title="center">
        <ion-nav-buttons side="left" >
            <button ui-sref="onboarding-log.medications.search" class="button back-button button-clear header-item">
                <i class="icon ion-arrow-left-c"></i>
            </button>
        </ion-nav-buttons>
    </ion-nav-bar>
    <ion-content class="light-bg has-footer">
        <div class="text-center">
            <ion-spinner class="orange-loading-spinner" icon="dots"
                         ng-if="medications.medication === null"></ion-spinner>
        </div>
        <ion-list ng-if="medications.medication" class="list orange-list">

            <ion-item class="item-title">
                <div class="row row-no-padding">
                    <div class="med-title col col-66">
                        <p class="med-name" ng-bind="medications.medication.brand"></p>
                        <p class="med-rx" ng-bind="medications.medication.name"></p>
                    </div>
                </div>
            </ion-item>

            <ion-item>
                <p class="text-muted">When is this medication taken?</p>
                <div button-bar="schedule.regularity" data-ng-model="schedule.selectedRegularity"></div>
            </ion-item>

            <ion-item class="orange-form">
                <p class="text-muted">Take with food?</p>
                <div button-bar="schedule.withFood" data-ng-model="schedule.schedule.take_with_food"></div>
                <p class="text-muted">How many units?</p>
                <label class="item-input">
                    <input type="number" ng-model="medications.medication.dose.quantity" placeholder="Quantity"/>
                </label>
            </ion-item>

            <div ng-if="schedule.schedule.regularly" class="orange-form">
                <ion-item>
                    <p class="text-muted">For how long</p>
                    <div button-bar="schedule.duration" data-ng-model="schedule.schedule.until.type"></div>

                    <div ng-if="schedule.schedule.until.type === 'number'" class="item-input">
                        <input type="number"
                               ng-model="schedule.schedule.until.stop"
                               placeholder="Number"/>
                    </div>

                    <div ng-if="schedule.schedule.until.type === 'date'" class="item-input">
                        <input type="text"
                               ng-model="schedule.schedule.until.stop"
                               placeholder="End Date"
                               datefield/>
                    </div>
                </ion-item>

                <ion-item>
                    <p class="text-muted">How often</p>
                    <div button-bar="schedule.frequency" data-ng-model="schedule.selectedFrequency"></div>

                    <div ng-if="schedule.selectedFrequency === 'daily'">
                        <p class="text-muted">Every # day?</p>
                        <label class="item-input">
                            <input type="number"
                                   ng-model="schedule.schedule.frequency.n"
                                   placeholder="End Date"
                                    />
                        </label>
                    </div>

                    <div ng-if="schedule.selectedFrequency === 'weekly'">
                        <p class="text-muted">Which days?</p>
                        <weekdays ng-model="schedule.schedule.frequency.exclude.exclude"></weekdays>
                    </div>

                    <div ng-if="schedule.selectedFrequency === 'monthly'">
                        <p class="text-muted">Which days?</p>
                        <calendar ng-model="schedule.schedule.frequency.start"></calendar>
                    </div>
                </ion-item>

                <ion-item class="item-footer">
                    <p class="text-muted">How many times a day do you take this medicine?</p>
                    <label class="item-input">
                        <input type="number" ng-model="schedule.eventsCount" placeholder="Number"/>
                    </label>
                </ion-item>
            </div>
        </ion-list>
    </ion-content>
    <div class="bottom-buttons">
        <button class="button button-full col col-no-padding button-orange"
                ng-click="schedule.continue(medications.medication)" ng-bind="schedule.buttonText"></button>
    </div>
</ion-view>
